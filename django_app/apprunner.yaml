version: 1.0
runtime: python311
build:
  commands:
    build:
      # - curl -o apk-tools-static-2.6.8-r1.apk http://dl-cdn.alpinelinux.org/alpine/v3.5/main/x86_64/apk-tools-static-2.6.9-r0.apk
      - sudo apk update
      - apk add pkg-config=0.29.2
      # - apk add libmysqlclient-dev
      - pip3 install -r requirements.txt
  env:
    - name: DJANGO_SETTINGS_MODULE
      value: "datalake_from_scratch.settings"
run:
  runtime-version: 3.11
  pre-run:
    - pip3 install -r requirements.txt
    - python3 manage.py makemigrations
    - python3 manage.py migrate
  command: python3 -m gunicorn datalake_from_scratch.wsgi
  network:
    port: 8000
    # env: MY_APP_PORT
  # env:
  #   - name: MY_VAR_EXAMPLE
  #     value: "example"
  # secrets:
  #   - name: my-secret
  #     value-from: "arn:aws:secretsmanager:us-east-1:123456789012:secret:testingstackAppRunnerConstr-kJFXde2ULKbT-S7t8xR:username::"
  #   - name: my-parameter
  #     value-from: "arn:aws:ssm:us-east-1:123456789012:parameter/parameter-name"
  #   - name: my-parameter-only-name
  #     value-from: "parameter-name"
